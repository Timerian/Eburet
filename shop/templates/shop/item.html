{% extends 'shop/default.html' %}

{% load static %}

{% block content %}
<div class="album py-5 m-auto" style="margin-top: 2%;">
    <div class="container-lg" style="margin-left: 15%;">
        <div class="row">
            <div class="gallery col">
                <div class="side-view">
                    {% for imageitem in item.imageitem_set.all %}
                    <img src="{% get_media_prefix %}/{{ imageitem.image.name }}" alt="" onclick="change(this.src)"
                        id="side" class="side">
                    {% endfor %}
                </div>

                <div class="main-view d-flex col">
                    <div class="container m-auto">
                        {% with item.imageitem_set.all|first as imageitem %}
                        {% with imageitem.image.name as imagename %}
                        <img src="{% get_media_prefix %}/{{ imagename }}" alt="" id="main" style="width: 100%;">
                        {% endwith %}
                        {% endwith %}
                    </div>
                </div>
            </div>
            <style>
                div p .pr-2 {
                    margin-bottom: 0;
                }
            </style>
            <div class="capture col m-1">
                <p class="fw-light hr-2">
                    {{ item.name }}
                </p>
                <p class="fw-light pr-2">
                    Артикул: {{ item.vendor_name }}
                </p>
                <p class="hr-3">
                    {{ item.price }} р.
                </p>


                <style>
                    .wrapper {
                        width: 100%;
                        height: 40px;
                        padding: 0;
                        display: flex;
                        justify-content: start;
                        align-items: center;
                        flex-direction: row;
                    }

                    .option {
                        width: 40px;
                        height: 40px;
                        background-color: transparent;
                        margin: 0;
                        display: flex;
                        align-items: center;
                        position: relative;
                    }

                    .option input {
                        display: none;
                    }

                    .option label {
                        font-family: 'Josefin Slab', sans-serif;
                        font-size: 60px;
                        cursor: pointer;
                    }

                    .option label::after {
                        content: "";
                        position: absolute;
                        right: 5px;
                        top: 20px;
                        transform: translateY(-50%);
                        width: 30px;
                        height: 30px;
                        border-radius: 50%;
                        background-color: var(--item-color);
                    }

                    .option label::before {
                        content: "";
                        position: absolute;
                        right: 2px;
                        top: 2px;
                        width: 36px;
                        height: 36px;
                        border: 1px solid rgb(160, 160, 160);
                        border-radius: 50%;
                        box-shadow: 0 0 0 0, 03;
                        opacity: 0;

                    }

                    .option input:hover~label::before {
                        border-color: black;
                        transition: 300ms;
                    }

                    .option input:checked~label::before {
                        opacity: 1;
                        transition: 300ms;
                    }
                </style>

                {% with item.colors.all as item_colors %}
                <div class="gallery">
                    <div class="row m-0">
                        <p class="pr-2 p-0 my-2 fw-light">Цвет:</p>
                        <div class="wrapper">
                            {% for item in item_colors %}
                            <div class="option">
                                <input class="select-color" type="radio" id="check{{item.id}}" name="radio"
                                    data-color="{{item.color}}">
                                <label for="check{{item.id}}" style="--item-color: {{item.color}}"></label>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                </div>
                {% endwith %}

                <div class="d-flex mx-auto my-4">
                    <style>
                        .stepper {
                            position: relative;
                            width: 150px;
                            height: 56px;
                            border-radius: 28px;
                            border: 2px solid grey;
                        }

                        .stepper .increment {
                            position: absolute;
                            top: 3%;
                            right: 30px;
                            display: block;
                            width: 12px;
                            height: 12px;
                            font-size: 30px;
                            cursor: pointer;
                        }

                        .stepper .decrement {
                            position: absolute;
                            top: 3%;
                            right: 110px;
                            display: block;
                            width: 12px;
                            height: 12px;
                            font-size: 30px;
                            cursor: pointer;

                        }

                        #box span {
                            position: absolute;
                            display: none;
                            width: 50%;
                            height: 100%;
                            top: 5%;
                            right: 39px;
                            text-align: center;
                            line-height: 45px;
                            font-size: 20px;
                        }
                        #box span[class='number']:nth-child(1){
                            display: initial;
                        }
                    </style>
                    <div class="stepper m-1 p-3">
                        <span class="decrement" onclick="prevNum()">-</span>
                        <span class="increment" onclick="nextNum()">+</span>
                        <div id="box"></div>                        
                    </div>
                    <script type="text/javascript">
                        var numbers = document.getElementById('box')
                        console.log(numbers)

                        for (i = 1; i < 20; i++) {
                            var span = document.createElement('span');
                            span.className += 'number'
                            span.textContent = i;
                            numbers.appendChild(span);
                        }

                        var num = document.getElementsByClassName('number');
                        var index = 0;

                        function nextNum(){
                            num[index].style.display = 'none';
                            index = (index + 1) % num.length;
                            num[index].style.display = 'initial';
                        }

                        function prevNum(){
                            num[index].style.display = 'none';
                            index = (index - 1 + num.length) % num.length;
                            num[index].style.display = 'initial';
                        }
                    </script>
                    <button class="btn p-0 update-cart" data-item="{{ item.id }}" data-action="add"
                        style="text-decoration: none;">
                        <div class="m-1 p-3"
                            style="display: inline-flex; align-items: center; background-color: rgb(255, 130, 151); border-radius: 50px 50px;">
                            <p class="mx-5 my-0" style="color: aliceblue;">КУПИТЬ</p>
                        </div>
                    </button>
                </div>

                <p class="fw-light hr-3">
                    {{ item.concept }}
                </p>
                <p class="fw-light pr-2">
                    {{ item.description }}
                </p>
                <p class="pr-1">
                    Параметры:
                </p>
                <p class="fw-light pr-2 m-0">
                <div class="fw-light pr-2">
                    {{ item.parameters|linebreaks }}
                </div>
                </p>
                {% if item.equipment %}
                <p class="pr-1">
                    Комплектация:
                </p>
                <p class="fw-light pr-2">
                    {{ item.equipment }}
                </p>
                {% endif %}
                <p class="pr-1">
                    Сроки изготовления:
                </p>
                <p class="fw-light pr-2">
                    {{ item.production_time }}
                </p>
                <p class="pr-1">
                    Материал:
                </p>
                <p class="fw-light pr-2">
                    {{ item.material }}
                </p>
                <p class="pr-1">
                    Особенности:
                </p>
                <p class="fw-light pr-2">
                    {{ item.peculiarities }}
                </p>
                <p class="pr-1">
                    Гарантийный срок:
                </p>
                <p class="fw-light pr-2">
                    {{ item.guarantee }}
                </p>
            </div>

        </div>
    </div>
</div>



<script>
    const change = src => {
        document.getElementById('main').src = src;
    }

    let sides = document.querySelectorAll(".side");


    function unselectAll() {
        for (let i = 0; i < sides.length; i++) {
            sides[i].style.border = "";
        }
    }

    sides.forEach(side => {
        side.addEventListener('click', function () {
            unselectAll();
            this.style.border = "1px solid rgb(200, 200, 200)"
        })
    })
</script>
{% endblock content %}